"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[456],{173:(t,e,n)=>{n.d(e,{l:()=>i});var s=n(992);function i(){const t=(0,s.ZG)().filter((t=>""!==t.weight&&""!==t.title));return t.length>1?t:void 0}},456:(t,e,n)=>{n.r(e),n.d(e,{default:()=>A});var s=n(691),i=n(398),o=n(836),a=n(992);const l={tag:"label",classNames:["label"]},c={tag:"input",classNames:["title"],attributes:{type:"text",placeholder:"title"}},r={tag:"input",classNames:["weight"],attributes:{type:"number",placeholder:"weight"}};class h extends i.n{constructor(t,e){super(t),this.onUpdate=e,this.inputTitleElement=new i.n(Object.assign(Object.assign({},c),{callback:this.onUpdate})),this.inputWeightElement=new i.n(Object.assign(Object.assign({},r),{callback:this.onUpdate})),this.labelElement=new i.n(l);const n={tag:"button",classNames:["button"],textContent:"Delete",callback:this.removeElement.bind(this)};this.button=new i.n(n),this.createElement(t)}setValueTitle(t){const e=this.inputTitleElement.getElement();e instanceof HTMLInputElement&&(e.value=t)}setValueWeight(t){const e=this.inputWeightElement.getElement();e instanceof HTMLInputElement&&(e.value=t.toString())}setValueId(t){const e=this.labelElement.getElement();e instanceof HTMLElement&&(e.textContent=t),this.element.id=t}getValues(){const t=this.inputTitleElement.getElement(),e=this.inputWeightElement.getElement(),n=this.labelElement.getElement();return{title:t instanceof HTMLInputElement?t.value:"",weight:e instanceof HTMLInputElement&&e.value||"",id:n.textContent||""}}removeElement(){this.element.remove(),(0,a.F9)(this.element.id),this.onRemove&&this.onRemove(this),this.onUpdate()}createElement(t){super.createElement(t),this.addInnerElement(this.labelElement),this.addInnerElement(this.inputTitleElement),this.addInnerElement(this.inputWeightElement),this.addInnerElement(this.button)}}const d={tag:"dialog",classNames:["dialog"]},m={tag:"form",classNames:["form"],callback:t=>{t.preventDefault()}},u={tag:"textarea",classNames:["textarea"],attributes:{placeholder:"textarea",name:"table",rows:"12",cols:"64"}};class p extends i.n{constructor(t){super(d),this.onConfirmCallback=t,this.form=new i.n(m),this.textarea=new i.n(u);const e={tag:"button",classNames:["button","cancel-button"],textContent:"Cancel",attributes:{type:"button"},callback:this.close.bind(this)},n={tag:"button",classNames:["button","confirm-button"],textContent:"Confirm",callback:()=>{this.handleConfirm()}};this.cancelButton=new i.n(e),this.confirmButton=new i.n(n),this.addInnerElement(this.form),this.form.addInnerElement(this.textarea),this.form.addInnerElement(this.cancelButton),this.form.addInnerElement(this.confirmButton),this.setupEventListeners()}show(){const t=this.getElement();t instanceof HTMLDialogElement&&t.showModal()}close(){const t=this.getElement();t instanceof HTMLDialogElement&&t.close(),this.element.remove()}setupEventListeners(){const t=this.getElement();t instanceof HTMLDialogElement&&(t.addEventListener("click",(e=>{e.target===t&&this.close()})),t.addEventListener("keydown",(t=>{"Escape"===t.key&&this.close()})))}getValueTextarea(){const t=this.textarea.getElement();return t instanceof HTMLTextAreaElement?t.value:""}handleConfirm(){const t=function(t){if(!t)return[];const e=[];for(const n of t.split("\n")){const t=n.split(/[\t,]\s*/);if(0===t.length)continue;let s,i=t.slice(0,-1).join(" ").trim();const o=t.at(-1);Number.isNaN(Number(o))?i=t.join(" ").trim():s=o,e.push({title:i,weight:s})}return e}(this.getValueTextarea());this.onConfirmCallback(t);const e=this.textarea.getElement();e instanceof HTMLTextAreaElement&&(e.value=""),this.close()}}var g=n(173);const f={tag:"dialog",classNames:["dialog"]},E={tag:"div",classNames:["modal-container"]},v={tag:"h3",classNames:["modal-title"],textContent:"Please add at least 2 valid options"},I={tag:"p",classNames:["modal-text"],textContent:"An option is considered valid if its title is not empty and its weight is greater than 0"};class b extends i.n{constructor(){super(f),this.container=new i.n(E),this.title=new i.n(v),this.text=new i.n(I);const t={tag:"button",classNames:["button","close-button"],textContent:"Close",callback:this.close.bind(this)};this.closeButton=new i.n(t),this.addInnerElement(this.container),this.container.addInnerElement(this.title),this.container.addInnerElement(this.text),this.container.addInnerElement(this.closeButton),this.setupEventListeners()}show(){const t=this.getElement();t instanceof HTMLDialogElement&&t.showModal()}close(){const t=this.getElement();t instanceof HTMLDialogElement&&t.close(),this.element.remove()}setupEventListeners(){const t=this.getElement();t instanceof HTMLDialogElement&&(t.addEventListener("click",(e=>{e.target===t&&this.close()})),t.addEventListener("keydown",(t=>{"Escape"===t.key&&this.close()})))}}var w=function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function a(t){try{c(s.next(t))}catch(t){o(t)}}function l(t){try{c(s.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,l)}c((s=s.apply(t,e||[])).next())}))};const C="button",L="add-option-button",x="paste-list-button",O="clear-list-button",N="save-list-button",T="load-list-button",k="start-button",y={tag:"section",classNames:["options"]},V={tag:"ul",classNames:["option-list"]};class A extends s.A{constructor(t,e,n=y){super(n),this.optionParames={tag:"li",classNames:["option"]},this.optionIdCounter=1,this.optionInstances=[],this.sounds=e,this.creatorList=new i.n(V),this.dialog=new p((t=>this.pasteList(t))),this.configureView(t)}configureView(t){const e=[{class:L,text:"Add Option",action:()=>this.createAndAddOption()},{class:x,text:"Paste list",action:()=>{document.body.append(this.dialog.getElement()),this.dialog.show()}},{class:O,text:"Clear list",action:()=>this.clearOptions()},{class:N,text:"Save list to file",action:()=>this.saveListToFile()},{class:T,text:"Load list from file",action:()=>this.loadListFromFile()},{class:k,text:"Start",action:()=>{if(!(0,g.l)()){const t=new b;document.body.append(t.getElement()),t.show()}t.navigate(o.b.DECISION_PICKER)}}];this.loadOptions(),this.viewElementCreator.addInnerElement(this.creatorList);for(const{class:t,text:n,action:s}of e){const e={tag:"button",classNames:[C,t],textContent:n,callback:s};this.viewElementCreator.addInnerElement(new i.n(e))}}createAndAddOption(){const t=new h(this.optionParames,(()=>{0===this.optionInstances.length&&(this.optionIdCounter=1),this.saveOptions()})),e=`#${this.optionIdCounter}`;t.setValueId(`${e}`),this.optionIdCounter++,t.onRemove=t=>{this.removeOptionInstance(t)},this.optionInstances.push(t),this.creatorList.addInnerElement(t),this.saveOptions()}getOptionsData(){return this.optionInstances.map((t=>t.getValues()))}saveOptions(){const t=this.getOptionsData();(0,a.Sz)(t),localStorage.setItem("optionIdCounter",String(this.optionIdCounter))}removeOptionInstance(t){this.optionInstances=this.optionInstances.filter((e=>e!==t)),this.saveOptions()}loadOptions(){const t=(0,a.ZG)(),e=localStorage.getItem("optionIdCounter");if(e&&(this.optionIdCounter=Number.parseInt(e,10)),e)for(const e of t){const t=new h(this.optionParames,(()=>this.saveOptions()));t.setValueId(e.id),t.setValueTitle(e.title),t.setValueWeight(e.weight),t.onRemove=t=>this.removeOptionInstance(t),this.optionInstances.push(t),this.creatorList.addInnerElement(t)}else this.createAndAddOption()}clearOptions(){(0,a.Q$)();const t=this.creatorList.getElement();for(;t.firstChild;)t.firstChild.remove();this.optionIdCounter=1,this.optionInstances=[],this.saveOptions()}saveListToFile(){const t={list:(0,a.ZG)(),lastId:this.optionIdCounter-1},e=JSON.stringify(t,void 0,2),n=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(n),i=document.createElement("a");i.href=s,i.download="option-list.json",i.click(),URL.revokeObjectURL(s)}loadListFromFile(){const t=document.createElement("input");t.type="file",t.accept="application/json",t.addEventListener("change",(t=>w(this,void 0,void 0,(function*(){var e;const n=t.target;if(n instanceof HTMLInputElement){const t=null===(e=n.files)||void 0===e?void 0:e[0];if(!t)return;const s=yield t.text(),i=JSON.parse(s);if(!i.list||!Array.isArray(i.list)||"number"!=typeof i.lastId)return console.warn("Invalid file format, creating a new option."),void this.createAndAddOption();this.clearOptions(),this.optionIdCounter=i.lastId+1;for(const t of i.list){const e=new h(this.optionParames,(()=>this.saveOptions()));e.setValueId(t.id),e.setValueTitle(t.title),e.setValueWeight(t.weight),e.onRemove=t=>this.removeOptionInstance(t),this.optionInstances.push(e),this.creatorList.addInnerElement(e)}this.saveOptions()}else console.error("Unexpected target type:",n)})))),t.click()}pasteList(t){console.log("Received parsed data:",t);for(const e of t){const t=new h(this.optionParames,(()=>this.saveOptions())),n=`#${this.optionIdCounter}`;t.setValueId(n),t.setValueTitle(e.title);const s=e.weight||"";t.setValueWeight(s),t.onRemove=t=>this.removeOptionInstance(t),this.optionInstances.push(t),this.creatorList.addInnerElement(t),this.optionIdCounter++}this.saveOptions()}}},992:(t,e,n)=>{function s(t){localStorage.setItem("options-makholodova",JSON.stringify(t))}function i(){const t=localStorage.getItem("options-makholodova");if(t)try{const e=JSON.parse(t);if(Array.isArray(e)&&e.every((t=>"id"in t&&"title"in t&&"weight"in t)))return e}catch(t){console.error("Failed to parse saved options:",t)}return[]}function o(){localStorage.removeItem("options-makholodova"),localStorage.removeItem("optionIdCounter")}function a(t){s(i().filter((e=>e.id!==t)))}n.d(e,{F9:()=>a,Q$:()=>o,Sz:()=>s,ZG:()=>i})}}]);